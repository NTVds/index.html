<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema Galego Cell - Gestão Completa</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .nav-btn.active {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);
        }
        .nav-btn:hover {
            background-color: #f3f4f6;
            transform: translateY(-1px);
        }
        .nav-btn.active:hover {
            background: linear-gradient(135deg, #2563eb, #1e40af);
        }
        .module {
            display: none;
        }
        .module.active {
            display: block;
        }
        .fade-in {
            animation: fadeIn 0.4s ease-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .card-hover {
            transition: all 0.3s ease;
        }
        .card-hover:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        .status-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
        }
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .glass-effect {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .btn-primary {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            transition: all 0.3s ease;
        }
        .btn-primary:hover {
            background: linear-gradient(135deg, #2563eb, #1e40af);
            transform: translateY(-1px);
            box-shadow: 0 8px 20px rgba(59, 130, 246, 0.3);
        }
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            backdrop-filter: blur(5px);
        }
        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .modal-content {
            background: white;
            border-radius: 15px;
            padding: 30px;
            max-width: 90vw;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 25px 50px rgba(0,0,0,0.2);
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 min-h-screen">
    <!-- Header -->
    <header class="gradient-bg text-white shadow-2xl">
        <div class="container mx-auto px-6 py-6">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <div class="bg-white bg-opacity-20 p-3 rounded-full">
                        <i class="fas fa-mobile-alt text-3xl"></i>
                    </div>
                    <div>
                        <h1 class="text-2xl font-bold">ASSISTÊNCIA GALEGO CELL</h1>
                        <p class="text-sm opacity-90">Sistema de Gestão Profissional</p>
                    </div>
                </div>
                <div class="text-right">
                    <p class="flex items-center justify-end mb-1"><i class="fas fa-phone mr-2"></i> (84) 98718-1612</p>
                    <p class="flex items-center justify-end"><i class="fas fa-map-marker-alt mr-2"></i> Rua Tijuana, 19</p>
                </div>
            </div>
        </div>
    </header>

    <!-- Navigation -->
    <nav class="glass-effect sticky top-0 z-40 shadow-lg">
        <div class="container mx-auto px-6">
            <div class="flex space-x-2 overflow-x-auto py-2">
                <button onclick="showModule('dashboard')" class="nav-btn active px-6 py-3 text-sm font-medium rounded-full transition-all duration-300 whitespace-nowrap">
                    <i class="fas fa-chart-pie mr-2"></i>Dashboard
                </button>
                <button onclick="showModule('vendas')" class="nav-btn px-6 py-3 text-sm font-medium rounded-full transition-all duration-300 whitespace-nowrap">
                    <i class="fas fa-shopping-cart mr-2"></i>Vendas
                </button>
                <button onclick="showModule('estoque')" class="nav-btn px-6 py-3 text-sm font-medium rounded-full transition-all duration-300 whitespace-nowrap">
                    <i class="fas fa-boxes mr-2"></i>Estoque
                </button>
                <button onclick="showModule('servicos')" class="nav-btn px-6 py-3 text-sm font-medium rounded-full transition-all duration-300 whitespace-nowrap">
                    <i class="fas fa-tools mr-2"></i>Ordens de Serviço
                </button>
                <button onclick="showModule('clientes')" class="nav-btn px-6 py-3 text-sm font-medium rounded-full transition-all duration-300 whitespace-nowrap">
                    <i class="fas fa-users mr-2"></i>Clientes
                </button>
                <button onclick="showModule('financeiro')" class="nav-btn px-6 py-3 text-sm font-medium rounded-full transition-all duration-300 whitespace-nowrap">
                    <i class="fas fa-chart-line mr-2"></i>Financeiro
                </button>
                <button onclick="showModule('relatorios')" class="nav-btn px-6 py-3 text-sm font-medium rounded-full transition-all duration-300 whitespace-nowrap">
                    <i class="fas fa-file-alt mr-2"></i>Relatórios
                </button>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="container mx-auto px-6 py-8">
        <!-- Dashboard -->
        <div id="dashboard" class="module active fade-in">
            <div class="mb-8">
                <h2 class="text-3xl font-bold text-gray-800 mb-2">Dashboard</h2>
                <p class="text-gray-600">Visão geral do seu negócio</p>
            </div>

            <!-- Cards de Indicadores -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                <div class="glass-effect p-6 rounded-2xl card-hover">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm text-gray-600 mb-1">OS Abertas</p>
                            <p id="dashOSAbertas" class="text-2xl font-bold text-blue-600">0</p>
                        </div>
                        <div class="bg-blue-100 p-3 rounded-full">
                            <i class="fas fa-clipboard-list text-blue-600 text-xl"></i>
                        </div>
                    </div>
                </div>

                <div class="glass-effect p-6 rounded-2xl card-hover">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm text-gray-600 mb-1">OS Concluídas Hoje</p>
                            <p id="dashOSConcluidas" class="text-2xl font-bold text-green-600">0</p>
                        </div>
                        <div class="bg-green-100 p-3 rounded-full">
                            <i class="fas fa-check-circle text-green-600 text-xl"></i>
                        </div>
                    </div>
                </div>

                <div class="glass-effect p-6 rounded-2xl card-hover">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm text-gray-600 mb-1">Faturamento Hoje</p>
                            <p id="dashFaturamento" class="text-2xl font-bold text-purple-600">R$ 0,00</p>
                        </div>
                        <div class="bg-purple-100 p-3 rounded-full">
                            <i class="fas fa-dollar-sign text-purple-600 text-xl"></i>
                        </div>
                    </div>
                </div>

                <div class="glass-effect p-6 rounded-2xl card-hover">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm text-gray-600 mb-1">Clientes Ativos</p>
                            <p id="dashClientes" class="text-2xl font-bold text-orange-600">0</p>
                        </div>
                        <div class="bg-orange-100 p-3 rounded-full">
                            <i class="fas fa-users text-orange-600 text-xl"></i>
                        </div>
                    </div>
                </div>
            </div>

            <!-- OS Recentes e Alertas -->
            <div class="grid lg:grid-cols-2 gap-8">
                <div class="glass-effect p-6 rounded-2xl">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">OS Recentes</h3>
                    <div id="dashOSRecentes" class="space-y-3">
                        <!-- OS recentes serão carregadas aqui -->
                    </div>
                </div>

                <div class="glass-effect p-6 rounded-2xl">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">Alertas e Notificações</h3>
                    <div id="dashAlertas" class="space-y-3">
                        <!-- Alertas serão carregados aqui -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Módulo Vendas -->
        <div id="vendas" class="module">
            <div class="glass-effect rounded-2xl shadow-xl p-8">
                <h2 class="text-3xl font-bold text-gray-800 mb-8 flex items-center">
                    <i class="fas fa-shopping-cart mr-4 text-blue-600"></i>Sistema de Vendas
                </h2>
                
                <div class="grid lg:grid-cols-2 gap-8">
                    <!-- Formulário de Venda -->
                    <div class="space-y-6">
                        <h3 class="text-xl font-semibold text-gray-700">Nova Venda</h3>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Cliente</label>
                            <input type="text" id="clienteVenda" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all" placeholder="Nome do cliente">
                        </div>
                        
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Produto</label>
                                <select id="produtoVenda" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all">
                                    <option value="">Selecione um produto</option>
                                    <option value="Película de Vidro">Película de Vidro - R$ 15,00</option>
                                    <option value="Capinha">Capinha - R$ 25,00</option>
                                    <option value="Carregador">Carregador - R$ 35,00</option>
                                    <option value="Fone de Ouvido">Fone de Ouvido - R$ 45,00</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Quantidade</label>
                                <input type="number" id="quantidadeVenda" min="1" value="1" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all">
                            </div>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Valor Total</label>
                            <input type="text" id="valorVenda" class="w-full px-4 py-3 border border-gray-300 rounded-xl bg-gray-50" readonly>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Forma de Pagamento</label>
                            <select id="pagamentoVenda" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all">
                                <option value="Dinheiro">Dinheiro</option>
                                <option value="Cartão de Débito">Cartão de Débito</option>
                                <option value="Cartão de Crédito">Cartão de Crédito</option>
                                <option value="PIX">PIX</option>
                            </select>
                        </div>
                        
                        <button onclick="registrarVenda()" class="w-full btn-primary text-white py-3 px-6 rounded-xl font-medium">
                            <i class="fas fa-plus mr-2"></i>Registrar Venda
                        </button>
                    </div>
                    
                    <!-- Lista de Vendas -->
                    <div>
                        <h3 class="text-xl font-semibold text-gray-700 mb-6">Vendas do Dia</h3>
                        <div id="listaVendas" class="space-y-4 max-h-96 overflow-y-auto">
                            <!-- Vendas serão adicionadas aqui -->
                        </div>
                        <div class="mt-6 p-4 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl">
                            <p class="text-sm text-gray-600">Total do Dia: <span id="totalDia" class="font-bold text-blue-600 text-lg">R$ 0,00</span></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Módulo Estoque -->
        <div id="estoque" class="module">
            <div class="glass-effect rounded-2xl shadow-xl p-8">
                <h2 class="text-3xl font-bold text-gray-800 mb-8 flex items-center">
                    <i class="fas fa-boxes mr-4 text-green-600"></i>Controle de Estoque
                </h2>
                
                <div class="grid lg:grid-cols-2 gap-8">
                    <!-- Adicionar Produto -->
                    <div class="space-y-6">
                        <h3 class="text-xl font-semibold text-gray-700">Adicionar Produto</h3>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Nome do Produto</label>
                            <input type="text" id="nomeProduto" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-all" placeholder="Ex: Película de Vidro iPhone 12">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Código do Produto</label>
                            <input type="text" id="codigoProduto" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-all" placeholder="Ex: PEL001">
                        </div>
                        
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Preço de Compra</label>
                                <input type="number" id="precoCompra" step="0.01" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-all" placeholder="0,00">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Preço de Venda</label>
                                <input type="number" id="precoVenda" step="0.01" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-all" placeholder="0,00">
                            </div>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Quantidade</label>
                            <input type="number" id="quantidadeProduto" min="0" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-all" placeholder="0">
                        </div>
                        
                        <button onclick="adicionarProduto()" class="w-full bg-gradient-to-r from-green-500 to-green-600 text-white py-3 px-6 rounded-xl font-medium hover:from-green-600 hover:to-green-700 transition-all">
                            <i class="fas fa-plus mr-2"></i>Adicionar ao Estoque
                        </button>
                    </div>
                    
                    <!-- Lista de Produtos -->
                    <div>
                        <h3 class="text-xl font-semibold text-gray-700 mb-6">Produtos em Estoque</h3>
                        <div id="listaProdutos" class="space-y-4 max-h-96 overflow-y-auto">
                            <!-- Produtos serão adicionados aqui -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Módulo Ordens de Serviço -->
        <div id="servicos" class="module">
            <div class="glass-effect rounded-2xl shadow-xl p-8">
                <div class="flex justify-between items-center mb-8">
                    <h2 class="text-3xl font-bold text-gray-800 flex items-center">
                        <i class="fas fa-tools mr-4 text-orange-600"></i>Ordens de Serviço
                    </h2>
                    <button onclick="abrirModalNovaOS()" class="btn-primary text-white px-6 py-3 rounded-xl font-medium">
                        <i class="fas fa-plus mr-2"></i>Nova OS
                    </button>
                </div>
                
                <!-- Filtros -->
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                    <select id="filtroStatus" onchange="filtrarOS()" class="px-4 py-2 border border-gray-300 rounded-xl focus:ring-2 focus:ring-orange-500">
                        <option value="">Todos os Status</option>
                        <option value="Aberta">Aberta</option>
                        <option value="Em Andamento">Em Andamento</option>
                        <option value="Aguardando Peça">Aguardando Peça</option>
                        <option value="Concluída">Concluída</option>
                        <option value="Entregue">Entregue</option>
                        <option value="Cancelada">Cancelada</option>
                    </select>
                    
                    <input type="text" id="filtroCliente" onkeyup="filtrarOS()" placeholder="Buscar por cliente" class="px-4 py-2 border border-gray-300 rounded-xl focus:ring-2 focus:ring-orange-500">
                    
                    <input type="date" id="filtroData" onchange="filtrarOS()" class="px-4 py-2 border border-gray-300 rounded-xl focus:ring-2 focus:ring-orange-500">
                    
                    <button onclick="limparFiltros()" class="bg-gray-500 text-white px-4 py-2 rounded-xl hover:bg-gray-600 transition-all">
                        <i class="fas fa-times mr-2"></i>Limpar
                    </button>
                </div>
                
                <!-- Lista de OS -->
                <div id="listaOS" class="grid gap-6">
                    <!-- OS serão carregadas aqui -->
                </div>
            </div>
        </div>

        <!-- Módulo Clientes -->
        <div id="clientes" class="module">
            <div class="glass-effect rounded-2xl shadow-xl p-8">
                <div class="flex justify-between items-center mb-8">
                    <h2 class="text-3xl font-bold text-gray-800 flex items-center">
                        <i class="fas fa-users mr-4 text-indigo-600"></i>Gestão de Clientes
                    </h2>
                    <button onclick="abrirModalNovoCliente()" class="btn-primary text-white px-6 py-3 rounded-xl font-medium">
                        <i class="fas fa-user-plus mr-2"></i>Novo Cliente
                    </button>
                </div>
                
                <!-- Busca de Clientes -->
                <div class="mb-6">
                    <input type="text" id="buscaCliente" onkeyup="buscarClientes()" placeholder="Buscar cliente por nome, telefone ou CPF..." class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500">
                </div>
                
                <!-- Lista de Clientes -->
                <div id="listaClientes" class="grid gap-4">
                    <!-- Clientes serão carregados aqui -->
                </div>
            </div>
        </div>

        <!-- Módulo Financeiro -->
        <div id="financeiro" class="module">
            <div class="glass-effect rounded-2xl shadow-xl p-8">
                <h2 class="text-3xl font-bold text-gray-800 mb-8 flex items-center">
                    <i class="fas fa-chart-line mr-4 text-purple-600"></i>Controle Financeiro
                </h2>
                
                <!-- Cards de Resumo -->
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                    <div class="bg-gradient-to-br from-green-50 to-green-100 p-6 rounded-2xl border border-green-200">
                        <div class="flex items-center">
                            <div class="bg-green-500 p-3 rounded-full mr-4">
                                <i class="fas fa-arrow-up text-white text-xl"></i>
                            </div>
                            <div>
                                <p class="text-sm text-gray-600">Receitas</p>
                                <p id="totalReceitas" class="text-2xl font-bold text-green-600">R$ 0,00</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-gradient-to-br from-red-50 to-red-100 p-6 rounded-2xl border border-red-200">
                        <div class="flex items-center">
                            <div class="bg-red-500 p-3 rounded-full mr-4">
                                <i class="fas fa-arrow-down text-white text-xl"></i>
                            </div>
                            <div>
                                <p class="text-sm text-gray-600">Despesas</p>
                                <p id="totalDespesas" class="text-2xl font-bold text-red-600">R$ 0,00</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-gradient-to-br from-blue-50 to-blue-100 p-6 rounded-2xl border border-blue-200">
                        <div class="flex items-center">
                            <div class="bg-blue-500 p-3 rounded-full mr-4">
                                <i class="fas fa-wallet text-white text-xl"></i>
                            </div>
                            <div>
                                <p class="text-sm text-gray-600">Saldo</p>
                                <p id="saldoTotal" class="text-2xl font-bold text-blue-600">R$ 0,00</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-gradient-to-br from-yellow-50 to-yellow-100 p-6 rounded-2xl border border-yellow-200">
                        <div class="flex items-center">
                            <div class="bg-yellow-500 p-3 rounded-full mr-4">
                                <i class="fas fa-chart-bar text-white text-xl"></i>
                            </div>
                            <div>
                                <p class="text-sm text-gray-600">Meta Mensal</p>
                                <p class="text-2xl font-bold text-yellow-600">R$ 5.000,00</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="grid lg:grid-cols-2 gap-8">
                    <!-- Adicionar Transação -->
                    <div class="space-y-6">
                        <h3 class="text-xl font-semibold text-gray-700">Nova Transação</h3>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Tipo</label>
                            <select id="tipoTransacao" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-all">
                                <option value="receita">Receita</option>
                                <option value="despesa">Despesa</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Descrição</label>
                            <input type="text" id="descricaoTransacao" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-all" placeholder="Ex: Venda de capinha">
                        </div>
                        
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Valor</label>
                                <input type="number" id="valorTransacao" step="0.01" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-all" placeholder="0,00">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Data</label>
                                <input type="date" id="dataTransacao" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-all">
                            </div>
                        </div>
                        
                        <button onclick="adicionarTransacao()" class="w-full bg-gradient-to-r from-purple-500 to-purple-600 text-white py-3 px-6 rounded-xl font-medium hover:from-purple-600 hover:to-purple-700 transition-all">
                            <i class="fas fa-plus mr-2"></i>Adicionar Transação
                        </button>
                    </div>
                    
                    <!-- Lista de Transações -->
                    <div>
                        <h3 class="text-xl font-semibold text-gray-700 mb-6">Transações Recentes</h3>
                        <div id="listaTransacoes" class="space-y-4 max-h-96 overflow-y-auto">
                            <!-- Transações serão adicionadas aqui -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Módulo Relatórios -->
        <div id="relatorios" class="module">
            <div class="glass-effect rounded-2xl shadow-xl p-8">
                <h2 class="text-3xl font-bold text-gray-800 mb-8 flex items-center">
                    <i class="fas fa-file-alt mr-4 text-indigo-600"></i>Relatórios
                </h2>
                
                <div class="grid lg:grid-cols-2 gap-8">
                    <!-- Filtros -->
                    <div class="space-y-6">
                        <h3 class="text-xl font-semibold text-gray-700">Gerar Relatório</h3>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Tipo de Relatório</label>
                            <select id="tipoRelatorio" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all">
                                <option value="vendas">Relatório de Vendas</option>
                                <option value="servicos">Relatório de Serviços</option>
                                <option value="financeiro">Relatório Financeiro</option>
                                <option value="estoque">Relatório de Estoque</option>
                                <option value="clientes">Relatório de Clientes</option>
                            </select>
                        </div>
                        
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Data Inicial</label>
                                <input type="date" id="dataInicial" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Data Final</label>
                                <input type="date" id="dataFinal" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all">
                            </div>
                        </div>
                        
                        <div class="space-y-3">
                            <button onclick="gerarRelatorio()" class="w-full bg-gradient-to-r from-indigo-500 to-indigo-600 text-white py-3 px-6 rounded-xl font-medium hover:from-indigo-600 hover:to-indigo-700 transition-all">
                                <i class="fas fa-chart-bar mr-2"></i>Gerar Relatório
                            </button>
                            <button onclick="exportarPDF()" class="w-full bg-gradient-to-r from-red-500 to-red-600 text-white py-3 px-6 rounded-xl font-medium hover:from-red-600 hover:to-red-700 transition-all">
                                <i class="fas fa-file-pdf mr-2"></i>Exportar PDF
                            </button>
                        </div>
                    </div>
                    
                    <!-- Área do Relatório -->
                    <div>
                        <h3 class="text-xl font-semibold text-gray-700 mb-6">Resultado</h3>
                        <div id="areaRelatorio" class="bg-gray-50 p-6 rounded-xl min-h-96 border-2 border-dashed border-gray-300">
                            <p class="text-gray-500 text-center">Selecione os filtros e clique em "Gerar Relatório" para visualizar os dados</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Modal Nova OS -->
    <div id="modalNovaOS" class="modal">
        <div class="modal-content" style="width: 90%; max-width: 1200px;">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-2xl font-bold text-gray-800">Nova Ordem de Serviço</h3>
                <button onclick="fecharModalNovaOS()" class="text-gray-500 hover:text-gray-700 text-2xl">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <form id="formNovaOS" class="space-y-8">
                <!-- Dados do Cliente -->
                <div class="bg-blue-50 p-6 rounded-xl">
                    <h4 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                        <i class="fas fa-user mr-2 text-blue-600"></i>Dados do Cliente
                    </h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Nome Completo *</label>
                            <input type="text" id="osClienteNome" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Telefone *</label>
                            <input type="tel" id="osClienteTelefone" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">CPF/CNPJ</label>
                            <input type="text" id="osClienteDocumento" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div class="md:col-span-2">
                            <label class="block text-sm font-medium text-gray-700 mb-1">Endereço</label>
                            <input type="text" id="osClienteEndereco" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">E-mail</label>
                            <input type="email" id="osClienteEmail" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        </div>
                    </div>
                </div>

                <!-- Dados do Aparelho -->
                <div class="bg-green-50 p-6 rounded-xl">
                    <h4 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                        <i class="fas fa-mobile-alt mr-2 text-green-600"></i>Dados do Aparelho
                    </h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Marca *</label>
                            <input type="text" id="osAparelhoMarca" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Modelo *</label>
                            <input type="text" id="osAparelhoModelo" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">IMEI/Número de Série</label>
                            <input type="text" id="osAparelhoIMEI" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500">
                        </div>
                        <div class="md:col-span-3">
                            <label class="block text-sm font-medium text-gray-700 mb-1">Acessórios Entregues</label>
                            <textarea id="osAparelhoAcessorios" rows="2" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500" placeholder="Ex: Carregador, fone de ouvido, capa..."></textarea>
                        </div>
                    </div>
                </div>

                <!-- Problema e Diagnóstico -->
                <div class="bg-orange-50 p-6 rounded-xl">
                    <h4 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                        <i class="fas fa-exclamation-triangle mr-2 text-orange-600"></i>Problema e Diagnóstico
                    </h4>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Defeito Relatado pelo Cliente *</label>
                            <textarea id="osDefeitoRelatado" required rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500" placeholder="Descreva o problema relatado pelo cliente..."></textarea>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Problemas Comuns (clique para adicionar)</label>
                            <div class="flex flex-wrap gap-2">
                                <button type="button" onclick="adicionarProblemaComum('Tela quebrada')" class="px-3 py-1 bg-gray-200 text-gray-700 rounded-full text-sm hover:bg-gray-300">Tela quebrada</button>
                                <button type="button" onclick="adicionarProblemaComum('Não carrega')" class="px-3 py-1 bg-gray-200 text-gray-700 rounded-full text-sm hover:bg-gray-300">Não carrega</button>
                                <button type="button" onclick="adicionarProblemaComum('Não liga')" class="px-3 py-1 bg-gray-200 text-gray-700 rounded-full text-sm hover:bg-gray-300">Não liga</button>
                                <button type="button" onclick="adicionarProblemaComum('Bateria viciada')" class="px-3 py-1 bg-gray-200 text-gray-700 rounded-full text-sm hover:bg-gray-300">Bateria viciada</button>
                                <button type="button" onclick="adicionarProblemaComum('Molhou')" class="px-3 py-1 bg-gray-200 text-gray-700 rounded-full text-sm hover:bg-gray-300">Molhou</button>
                                <button type="button" onclick="adicionarProblemaComum('Touch não funciona')" class="px-3 py-1 bg-gray-200 text-gray-700 rounded-full text-sm hover:bg-gray-300">Touch não funciona</button>
                            </div>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Diagnóstico Inicial do Técnico</label>
                            <textarea id="osDiagnosticoInicial" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500" placeholder="Diagnóstico técnico inicial..."></textarea>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Técnico Responsável</label>
                                <select id="osTecnicoResponsavel" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500">
                                    <option value="">Selecione o técnico</option>
                                    <option value="João Silva">João Silva</option>
                                    <option value="Maria Santos">Maria Santos</option>
                                    <option value="Pedro Costa">Pedro Costa</option>
                                    <option value="Ana Oliveira">Ana Oliveira</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Prioridade</label>
                                <select id="osPrioridade" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500">
                                    <option value="Normal">Normal</option>
                                    <option value="Alta">Alta</option>
                                    <option value="Urgente">Urgente</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Orçamento e Prazos -->
                <div class="bg-purple-50 p-6 rounded-xl">
                    <h4 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                        <i class="fas fa-calculator mr-2 text-purple-600"></i>Orçamento e Prazos
                    </h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Valor Estimado</label>
                            <input type="number" id="osValorEstimado" step="0.01" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500" placeholder="0,00">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Prazo Estimado (dias)</label>
                            <input type="number" id="osPrazoEstimado" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500" placeholder="3">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Garantia (dias)</label>
                            <select id="osGarantia" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500">
                                <option value="30">30 dias</option>
                                <option value="60">60 dias</option>
                                <option value="90" selected>90 dias</option>
                                <option value="180">180 dias</option>
                                <option value="365">1 ano</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Status Inicial</label>
                            <select id="osStatusInicial" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500">
                                <option value="Aberta">Aberta</option>
                                <option value="Aguardando Orçamento">Aguardando Orçamento</option>
                                <option value="Orçamento Enviado">Orçamento Enviado</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Observações -->
                <div class="bg-gray-50 p-6 rounded-xl">
                    <h4 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                        <i class="fas fa-sticky-note mr-2 text-gray-600"></i>Observações Adicionais
                    </h4>
                    <textarea id="osObservacoes" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-500" placeholder="Observações gerais sobre o atendimento..."></textarea>
                </div>

                <!-- Botões -->
                <div class="flex justify-end space-x-4 pt-6 border-t">
                    <button type="button" onclick="fecharModalNovaOS()" class="px-6 py-3 bg-gray-500 text-white rounded-xl hover:bg-gray-600 transition-all">
                        <i class="fas fa-times mr-2"></i>Cancelar
                    </button>
                    <button type="submit" class="px-6 py-3 btn-primary text-white rounded-xl">
                        <i class="fas fa-save mr-2"></i>Criar Ordem de Serviço
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Novo Cliente -->
    <div id="modalNovoCliente" class="modal">
        <div class="modal-content" style="width: 90%; max-width: 800px;">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-2xl font-bold text-gray-800">Novo Cliente</h3>
                <button onclick="fecharModalNovoCliente()" class="text-gray-500 hover:text-gray-700 text-2xl">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <form id="formNovoCliente" class="space-y-6">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Nome Completo *</label>
                        <input type="text" id="clienteNome" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Telefone *</label>
                        <input type="tel" id="clienteTelefone" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">CPF/CNPJ</label>
                        <input type="text" id="clienteDocumento" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">E-mail</label>
                        <input type="email" id="clienteEmail" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500">
                    </div>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Endereço Completo</label>
                    <input type="text" id="clienteEndereco" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Observações</label>
                    <textarea id="clienteObservacoes" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500"></textarea>
                </div>

                <div class="flex justify-end space-x-4 pt-6 border-t">
                    <button type="button" onclick="fecharModalNovoCliente()" class="px-6 py-3 bg-gray-500 text-white rounded-xl hover:bg-gray-600 transition-all">
                        <i class="fas fa-times mr-2"></i>Cancelar
                    </button>
                    <button type="submit" class="px-6 py-3 btn-primary text-white rounded-xl">
                        <i class="fas fa-save mr-2"></i>Salvar Cliente
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Editar OS -->
    <div id="modalEditarOS" class="modal">
        <div class="modal-content" style="width: 90%; max-width: 1000px;">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-2xl font-bold text-gray-800">Editar Ordem de Serviço</h3>
                <button onclick="fecharModalEditarOS()" class="text-gray-500 hover:text-gray-700 text-2xl">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <div id="conteudoEditarOS">
                <!-- Conteúdo será carregado dinamicamente -->
            </div>
        </div>
    </div>

    <script>
        // Dados em memória
        let vendas = [];
        let produtos = [];
        let ordensServico = [];
        let clientes = [];
        let transacoes = [];
        let osEditandoId = null;

        // Inicialização
        document.addEventListener('DOMContentLoaded', function() {
            // Definir data atual nos campos de data
            const hoje = new Date().toISOString().split('T')[0];
            document.getElementById('dataTransacao').value = hoje;
            document.getElementById('dataInicial').value = hoje;
            document.getElementById('dataFinal').value = hoje;
            
            // Carregar dados salvos
            carregarDados();
            
            // Atualizar dashboard
            atualizarDashboard();
            
            // Configurar eventos
            configurarEventos();
        });

        function configurarEventos() {
            // Cálculo automático de vendas
            document.getElementById('produtoVenda').addEventListener('change', calcularValorVenda);
            document.getElementById('quantidadeVenda').addEventListener('input', calcularValorVenda);
            
            // Formulário de nova OS
            document.getElementById('formNovaOS').addEventListener('submit', function(e) {
                e.preventDefault();
                criarOS();
            });
            
            // Formulário de novo cliente
            document.getElementById('formNovoCliente').addEventListener('submit', function(e) {
                e.preventDefault();
                salvarCliente();
            });
        }

        // Navegação entre módulos
        function showModule(moduleId) {
            // Esconder todos os módulos
            document.querySelectorAll('.module').forEach(module => {
                module.classList.remove('active');
            });
            
            // Remover classe active de todos os botões
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Mostrar módulo selecionado
            document.getElementById(moduleId).classList.add('active', 'fade-in');
            
            // Ativar botão correspondente
            event.target.classList.add('active');
            
            // Atualizar dados específicos do módulo
            if (moduleId === 'dashboard') {
                atualizarDashboard();
            } else if (moduleId === 'servicos') {
                atualizarListaOS();
            } else if (moduleId === 'clientes') {
                atualizarListaClientes();
            }
        }

        // Funções do Dashboard
        function atualizarDashboard() {
            const hoje = new Date().toISOString().split('T')[0];
            
            // OS Abertas
            const osAbertas = ordensServico.filter(os => 
                os.status !== 'Entregue' && os.status !== 'Cancelada'
            ).length;
            document.getElementById('dashOSAbertas').textContent = osAbertas;
            
            // OS Concluídas hoje
            const osConcluidas = ordensServico.filter(os => 
                os.dataConclusao === hoje
            ).length;
            document.getElementById('dashOSConcluidas').textContent = osConcluidas;
            
            // Faturamento hoje
            const faturamentoHoje = ordensServico.filter(os => 
                os.dataConclusao === hoje && os.status === 'Entregue'
            ).reduce((total, os) => total + (os.valorFinal || 0), 0);
            document.getElementById('dashFaturamento').textContent = `R$ ${faturamentoHoje.toFixed(2)}`;
            
            // Clientes ativos
            document.getElementById('dashClientes').textContent = clientes.length;
            
            // OS Recentes
            atualizarOSRecentes();
            
            // Alertas
            atualizarAlertas();
        }

        function atualizarOSRecentes() {
            const osRecentes = ordensServico.slice(-5).reverse();
            const container = document.getElementById('dashOSRecentes');
            
            container.innerHTML = osRecentes.map(os => `
                <div class="flex items-center justify-between p-3 bg-white rounded-lg border">
                    <div>
                        <p class="font-medium">${os.numero}</p>
                        <p class="text-sm text-gray-600">${os.cliente.nome}</p>
                    </div>
                    <span class="status-badge ${getStatusClass(os.status)}">${os.status}</span>
                </div>
            `).join('') || '<p class="text-gray-500 text-center">Nenhuma OS registrada</p>';
        }

        function atualizarAlertas() {
            const alertas = [];
            const hoje = new Date();
            
            // OS atrasadas
            ordensServico.forEach(os => {
                if (os.prazoEstimado && os.status !== 'Entregue' && os.status !== 'Cancelada') {
                    const dataLimite = new Date(os.dataAbertura);
                    dataLimite.setDate(dataLimite.getDate() + os.prazoEstimado);
                    
                    if (hoje > dataLimite) {
                        alertas.push({
                            tipo: 'warning',
                            mensagem: `OS ${os.numero} está atrasada`,
                            icone: 'fas fa-exclamation-triangle'
                        });
                    }
                }
            });
            
            // Produtos com estoque baixo
            produtos.forEach(produto => {
                if (produto.quantidade <= 5) {
                    alertas.push({
                        tipo: 'info',
                        mensagem: `Estoque baixo: ${produto.nome} (${produto.quantidade} unidades)`,
                        icone: 'fas fa-box'
                    });
                }
            });
            
            const container = document.getElementById('dashAlertas');
            container.innerHTML = alertas.map(alerta => `
                <div class="flex items-center p-3 bg-white rounded-lg border border-l-4 ${alerta.tipo === 'warning' ? 'border-l-yellow-500' : 'border-l-blue-500'}">
                    <i class="${alerta.icone} ${alerta.tipo === 'warning' ? 'text-yellow-500' : 'text-blue-500'} mr-3"></i>
                    <p class="text-sm">${alerta.mensagem}</p>
                </div>
            `).join('') || '<p class="text-gray-500 text-center">Nenhum alerta no momento</p>';
        }

        // Funções de Vendas
        function calcularValorVenda() {
            const produto = document.getElementById('produtoVenda').value;
            const quantidade = parseInt(document.getElementById('quantidadeVenda').value) || 0;
            
            let preco = 0;
            if (produto.includes('15,00')) preco = 15;
            else if (produto.includes('25,00')) preco = 25;
            else if (produto.includes('35,00')) preco = 35;
            else if (produto.includes('45,00')) preco = 45;
            
            const total = preco * quantidade;
            document.getElementById('valorVenda').value = `R$ ${total.toFixed(2)}`;
        }

        function registrarVenda() {
            const cliente = document.getElementById('clienteVenda').value;
            const produto = document.getElementById('produtoVenda').value;
            const quantidade = parseInt(document.getElementById('quantidadeVenda').value);
            const valor = parseFloat(document.getElementById('valorVenda').value.replace('R$ ', ''));
            const pagamento = document.getElementById('pagamentoVenda').value;
            
            if (!cliente || !produto || !quantidade || !valor) {
                alert('Por favor, preencha todos os campos!');
                return;
            }
            
            const venda = {
                id: Date.now(),
                cliente,
                produto: produto.split(' - ')[0],
                quantidade,
                valor,
                pagamento,
                data: new Date().toLocaleString('pt-BR')
            };
            
            vendas.push(venda);
            salvarDados();
            atualizarListaVendas();
            limparFormularioVenda();
            
            // Adicionar automaticamente como receita
            const transacao = {
                id: Date.now() + 1,
                tipo: 'receita',
                descricao: `Venda: ${venda.produto}`,
                valor: venda.valor,
                data: new Date().toISOString().split('T')[0]
            };
            transacoes.push(transacao);
            atualizarResumoFinanceiro();
            
            alert('Venda registrada com sucesso!');
        }

        function atualizarListaVendas() {
            const lista = document.getElementById('listaVendas');
            const vendasHoje = vendas.filter(v => v.data.includes(new Date().toLocaleDateString('pt-BR')));
            
            lista.innerHTML = vendasHoje.map(venda => `
                <div class="glass-effect p-4 rounded-xl card-hover">
                    <div class="flex justify-between items-start">
                        <div>
                            <p class="font-medium text-gray-800">${venda.cliente}</p>
                            <p class="text-sm text-gray-600">${venda.produto} (${venda.quantidade}x)</p>
                            <p class="text-xs text-gray-500">${venda.pagamento}</p>
                        </div>
                        <div class="text-right">
                            <p class="font-bold text-green-600">R$ ${venda.valor.toFixed(2)}</p>
                            <p class="text-xs text-gray-500">${venda.data}</p>
                            <button onclick="gerarComprovanteVendaEspecifica(${venda.id})" class="mt-2 text-xs bg-blue-500 text-white px-3 py-1 rounded-full hover:bg-blue-600 transition-all">
                                <i class="fas fa-download mr-1"></i> PDF
                            </button>
                        </div>
                    </div>
                </div>
            `).join('') || '<p class="text-gray-500 text-center">Nenhuma venda registrada hoje</p>';
            
            const total = vendasHoje.reduce((sum, venda) => sum + venda.valor, 0);
            document.getElementById('totalDia').textContent = `R$ ${total.toFixed(2)}`;
        }

        function limparFormularioVenda() {
            document.getElementById('clienteVenda').value = '';
            document.getElementById('produtoVenda').value = '';
            document.getElementById('quantidadeVenda').value = '1';
            document.getElementById('valorVenda').value = '';
        }

        // Funções de Estoque
        function adicionarProduto() {
            const nome = document.getElementById('nomeProduto').value;
            const codigo = document.getElementById('codigoProduto').value;
            const precoCompra = parseFloat(document.getElementById('precoCompra').value);
            const precoVenda = parseFloat(document.getElementById('precoVenda').value);
            const quantidade = parseInt(document.getElementById('quantidadeProduto').value);
            
            if (!nome || !precoCompra || !precoVenda || quantidade < 0) {
                alert('Por favor, preencha todos os campos corretamente!');
                return;
            }
            
            const produto = {
                id: Date.now(),
                nome,
                codigo: codigo || `PROD${Date.now()}`,
                precoCompra,
                precoVenda,
                quantidade,
                data: new Date().toLocaleString('pt-BR')
            };
            
            produtos.push(produto);
            salvarDados();
            atualizarListaProdutos();
            limparFormularioProduto();
            
            alert('Produto adicionado com sucesso!');
        }

        function atualizarListaProdutos() {
            const lista = document.getElementById('listaProdutos');
            
            lista.innerHTML = produtos.map(produto => `
                <div class="glass-effect p-4 rounded-xl card-hover">
                    <div class="flex justify-between items-start">
                        <div class="flex-1">
                            <p class="font-medium text-gray-800">${produto.nome}</p>
                            <p class="text-sm text-gray-600">Código: ${produto.codigo}</p>
                            <p class="text-sm text-gray-600">Compra: R$ ${produto.precoCompra.toFixed(2)} | Venda: R$ ${produto.precoVenda.toFixed(2)}</p>
                            <p class="text-xs text-gray-500">Adicionado em: ${produto.data}</p>
                        </div>
                        <div class="text-right">
                            <p class="font-bold ${produto.quantidade > 10 ? 'text-green-600' : produto.quantidade > 5 ? 'text-yellow-600' : 'text-red-600'}">
                                ${produto.quantidade} unidades
                            </p>
                            <button onclick="removerProduto(${produto.id})" class="mt-2 text-red-500 hover:text-red-700 text-sm">
                                <i class="fas fa-trash"></i> Remover
                            </button>
                        </div>
                    </div>
                </div>
            `).join('') || '<p class="text-gray-500 text-center">Nenhum produto cadastrado</p>';
        }

        function removerProduto(id) {
            if (confirm('Tem certeza que deseja remover este produto?')) {
                produtos = produtos.filter(p => p.id !== id);
                salvarDados();
                atualizarListaProdutos();
            }
        }

        function limparFormularioProduto() {
            document.getElementById('nomeProduto').value = '';
            document.getElementById('codigoProduto').value = '';
            document.getElementById('precoCompra').value = '';
            document.getElementById('precoVenda').value = '';
            document.getElementById('quantidadeProduto').value = '';
        }

        // Funções de Ordens de Serviço
        function abrirModalNovaOS() {
            document.getElementById('modalNovaOS').classList.add('active');
        }

        function fecharModalNovaOS() {
            document.getElementById('modalNovaOS').classList.remove('active');
            document.getElementById('formNovaOS').reset();
        }

        function adicionarProblemaComum(problema) {
            const textarea = document.getElementById('osDefeitoRelatado');
            const valorAtual = textarea.value;
            
            if (valorAtual && !valorAtual.endsWith('. ') && !valorAtual.endsWith('.')) {
                textarea.value = valorAtual + '. ' + problema;
            } else {
                textarea.value = valorAtual + problema;
            }
        }

        function criarOS() {
            // Coletar dados do formulário
            const dadosOS = {
                // Cliente
                cliente: {
                    nome: document.getElementById('osClienteNome').value,
                    telefone: document.getElementById('osClienteTelefone').value,
                    documento: document.getElementById('osClienteDocumento').value,
                    endereco: document.getElementById('osClienteEndereco').value,
                    email: document.getElementById('osClienteEmail').value
                },
                // Aparelho
                aparelho: {
                    marca: document.getElementById('osAparelhoMarca').value,
                    modelo: document.getElementById('osAparelhoModelo').value,
                    imei: document.getElementById('osAparelhoIMEI').value,
                    acessorios: document.getElementById('osAparelhoAcessorios').value
                },
                // Problema
                defeitoRelatado: document.getElementById('osDefeitoRelatado').value,
                diagnosticoInicial: document.getElementById('osDiagnosticoInicial').value,
                tecnicoResponsavel: document.getElementById('osTecnicoResponsavel').value,
                prioridade: document.getElementById('osPrioridade').value,
                // Orçamento
                valorEstimado: parseFloat(document.getElementById('osValorEstimado').value) || 0,
                prazoEstimado: parseInt(document.getElementById('osPrazoEstimado').value) || 3,
                garantia: parseInt(document.getElementById('osGarantia').value),
                status: document.getElementById('osStatusInicial').value,
                observacoes: document.getElementById('osObservacoes').value
            };

            // Validar campos obrigatórios
            if (!dadosOS.cliente.nome || !dadosOS.cliente.telefone || 
                !dadosOS.aparelho.marca || !dadosOS.aparelho.modelo || 
                !dadosOS.defeitoRelatado) {
                alert('Por favor, preencha todos os campos obrigatórios!');
                return;
            }

            // Criar OS
            const os = {
                id: Date.now(),
                numero: `OS${String(ordensServico.length + 1).padStart(4, '0')}`,
                ...dadosOS,
                dataAbertura: new Date().toISOString().split('T')[0],
                dataAtualizacao: new Date().toISOString(),
                pecasUtilizadas: [],
                servicosRealizados: [],
                valorFinal: 0,
                historico: [{
                    data: new Date().toISOString(),
                    acao: 'OS Criada',
                    usuario: dadosOS.tecnicoResponsavel || 'Sistema',
                    observacao: 'Ordem de serviço criada'
                }]
            };

            // Verificar se cliente já existe, senão criar
            let clienteExistente = clientes.find(c => 
                c.telefone === dadosOS.cliente.telefone || 
                (dadosOS.cliente.documento && c.documento === dadosOS.cliente.documento)
            );

            if (!clienteExistente) {
                const novoCliente = {
                    id: Date.now() + 1,
                    ...dadosOS.cliente,
                    dataCadastro: new Date().toISOString(),
                    observacoes: ''
                };
                clientes.push(novoCliente);
            }

            ordensServico.push(os);
            salvarDados();
            atualizarListaOS();
            atualizarDashboard();
            fecharModalNovaOS();
            
            alert(`Ordem de Serviço ${os.numero} criada com sucesso!`);
            
            // Simular envio de WhatsApp
            simularEnvioWhatsApp(os, 'OS_CRIADA');
        }

        function atualizarListaOS() {
            const lista = document.getElementById('listaOS');
            let osFiltradas = [...ordensServico];
            
            // Aplicar filtros
            const filtroStatus = document.getElementById('filtroStatus').value;
            const filtroCliente = document.getElementById('filtroCliente').value.toLowerCase();
            const filtroData = document.getElementById('filtroData').value;
            
            if (filtroStatus) {
                osFiltradas = osFiltradas.filter(os => os.status === filtroStatus);
            }
            
            if (filtroCliente) {
                osFiltradas = osFiltradas.filter(os => 
                    os.cliente.nome.toLowerCase().includes(filtroCliente)
                );
            }
            
            if (filtroData) {
                osFiltradas = osFiltradas.filter(os => os.dataAbertura === filtroData);
            }
            
            // Ordenar por data (mais recentes primeiro)
            osFiltradas.sort((a, b) => new Date(b.dataAtualizacao) - new Date(a.dataAtualizacao));
            
            lista.innerHTML = osFiltradas.map(os => `
                <div class="glass-effect p-6 rounded-2xl card-hover">
                    <div class="flex justify-between items-start mb-4">
                        <div>
                            <h4 class="text-xl font-bold text-blue-600">${os.numero}</h4>
                            <p class="text-lg font-medium text-gray-800">${os.cliente.nome}</p>
                            <p class="text-sm text-gray-600">${os.cliente.telefone}</p>
                        </div>
                        <div class="text-right">
                            <span class="status-badge ${getStatusClass(os.status)}">${os.status}</span>
                            <p class="text-sm text-gray-600 mt-2">Prioridade: ${os.prioridade}</p>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <div>
                            <p class="text-sm"><strong>Aparelho:</strong> ${os.aparelho.marca} ${os.aparelho.modelo}</p>
                            <p class="text-sm"><strong>IMEI:</strong> ${os.aparelho.imei || 'Não informado'}</p>
                            <p class="text-sm"><strong>Técnico:</strong> ${os.tecnicoResponsavel || 'Não atribuído'}</p>
                        </div>
                        <div>
                            <p class="text-sm"><strong>Abertura:</strong> ${new Date(os.dataAbertura).toLocaleDateString('pt-BR')}</p>
                            <p class="text-sm"><strong>Prazo:</strong> ${os.prazoEstimado} dias</p>
                            <p class="text-sm"><strong>Garantia:</strong> ${os.garantia} dias</p>
                        </div>
                    </div>
                    
                    <div class="mb-4">
                        <p class="text-sm"><strong>Problema:</strong> ${os.defeitoRelatado}</p>
                        ${os.diagnosticoInicial ? `<p class="text-sm"><strong>Diagnóstico:</strong> ${os.diagnosticoInicial}</p>` : ''}
                    </div>
                    
                    <div class="flex justify-between items-center">
                        <div>
                            <p class="text-lg font-bold text-green-600">
                                ${os.valorFinal > 0 ? `R$ ${os.valorFinal.toFixed(2)}` : `Est. R$ ${os.valorEstimado.toFixed(2)}`}
                            </p>
                        </div>
                        <div class="flex space-x-2">
                            <button onclick="editarOS(${os.id})" class="bg-blue-500 text-white px-3 py-2 rounded-lg text-sm hover:bg-blue-600 transition-all">
                                <i class="fas fa-edit mr-1"></i> Editar
                            </button>
                            <button onclick="atualizarStatusOS(${os.id})" class="bg-green-500 text-white px-3 py-2 rounded-lg text-sm hover:bg-green-600 transition-all">
                                <i class="fas fa-sync mr-1"></i> Status
                            </button>
                            <button onclick="gerarComprovanteOSEspecifica(${os.id})" class="bg-purple-500 text-white px-3 py-2 rounded-lg text-sm hover:bg-purple-600 transition-all">
                                <i class="fas fa-file-pdf mr-1"></i> PDF
                            </button>
                        </div>
                    </div>
                </div>
            `).join('') || '<p class="text-gray-500 text-center col-span-full">Nenhuma ordem de serviço encontrada</p>';
        }

        function filtrarOS() {
            atualizarListaOS();
        }

        function limparFiltros() {
            document.getElementById('filtroStatus').value = '';
            document.getElementById('filtroCliente').value = '';
            document.getElementById('filtroData').value = '';
            atualizarListaOS();
        }

        function getStatusClass(status) {
            switch(status) {
                case 'Aberta': return 'bg-blue-100 text-blue-800';
                case 'Em Andamento': return 'bg-yellow-100 text-yellow-800';
                case 'Aguardando Peça': return 'bg-orange-100 text-orange-800';
                case 'Concluída': return 'bg-green-100 text-green-800';
                case 'Entregue': return 'bg-gray-100 text-gray-800';
                case 'Cancelada': return 'bg-red-100 text-red-800';
                default: return 'bg-gray-100 text-gray-800';
            }
        }

        function editarOS(id) {
            const os = ordensServico.find(o => o.id === id);
            if (!os) return;
            
            osEditandoId = id;
            
            // Criar conteúdo do modal de edição
            const conteudo = `
                <div class="space-y-6">
                    <!-- Status e Informações Básicas -->
                    <div class="bg-blue-50 p-4 rounded-xl">
                        <h4 class="text-lg font-semibold mb-4">Status e Informações</h4>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Status</label>
                                <select id="editStatus" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                                    <option value="Aberta" ${os.status === 'Aberta' ? 'selected' : ''}>Aberta</option>
                                    <option value="Em Andamento" ${os.status === 'Em Andamento' ? 'selected' : ''}>Em Andamento</option>
                                    <option value="Aguardando Peça" ${os.status === 'Aguardando Peça' ? 'selected' : ''}>Aguardando Peça</option>
                                    <option value="Concluída" ${os.status === 'Concluída' ? 'selected' : ''}>Concluída</option>
                                    <option value="Entregue" ${os.status === 'Entregue' ? 'selected' : ''}>Entregue</option>
                                    <option value="Cancelada" ${os.status === 'Cancelada' ? 'selected' : ''}>Cancelada</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Técnico</label>
                                <select id="editTecnico" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                                    <option value="">Selecione o técnico</option>
                                    <option value="João Silva" ${os.tecnicoResponsavel === 'João Silva' ? 'selected' : ''}>João Silva</option>
                                    <option value="Maria Santos" ${os.tecnicoResponsavel === 'Maria Santos' ? 'selected' : ''}>Maria Santos</option>
                                    <option value="Pedro Costa" ${os.tecnicoResponsavel === 'Pedro Costa' ? 'selected' : ''}>Pedro Costa</option>
                                    <option value="Ana Oliveira" ${os.tecnicoResponsavel === 'Ana Oliveira' ? 'selected' : ''}>Ana Oliveira</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Prioridade</label>
                                <select id="editPrioridade" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                                    <option value="Normal" ${os.prioridade === 'Normal' ? 'selected' : ''}>Normal</option>
                                    <option value="Alta" ${os.prioridade === 'Alta' ? 'selected' : ''}>Alta</option>
                                    <option value="Urgente" ${os.prioridade === 'Urgente' ? 'selected' : ''}>Urgente</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Diagnóstico e Serviços -->
                    <div class="bg-green-50 p-4 rounded-xl">
                        <h4 class="text-lg font-semibold mb-4">Diagnóstico e Serviços</h4>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Diagnóstico Técnico</label>
                                <textarea id="editDiagnostico" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-lg">${os.diagnosticoInicial || ''}</textarea>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Serviços Realizados</label>
                                <textarea id="editServicos" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-lg" placeholder="Descreva os serviços realizados...">${os.servicosRealizados.join(', ') || ''}</textarea>
                            </div>
                        </div>
                    </div>

                    <!-- Peças Utilizadas -->
                    <div class="bg-orange-50 p-4 rounded-xl">
                        <h4 class="text-lg font-semibold mb-4">Peças Utilizadas</h4>
                        <div id="listaPecasUtilizadas" class="space-y-2 mb-4">
                            ${os.pecasUtilizadas.map((peca, index) => `
                                <div class="flex items-center space-x-2 bg-white p-2 rounded">
                                    <input type="text" value="${peca.nome}" placeholder="Nome da peça" class="flex-1 px-2 py-1 border rounded">
                                    <input type="number" value="${peca.quantidade}" placeholder="Qtd" class="w-20 px-2 py-1 border rounded">
                                    <input type="number" value="${peca.valor}" step="0.01" placeholder="Valor" class="w-24 px-2 py-1 border rounded">
                                    <button onclick="removerPecaUtilizada(${index})" class="text-red-500 hover:text-red-700">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            `).join('')}
                        </div>
                        <button onclick="adicionarPecaUtilizada()" class="bg-orange-500 text-white px-4 py-2 rounded-lg hover:bg-orange-600">
                            <i class="fas fa-plus mr-2"></i>Adicionar Peça
                        </button>
                    </div>

                    <!-- Valores -->
                    <div class="bg-purple-50 p-4 rounded-xl">
                        <h4 class="text-lg font-semibold mb-4">Valores</h4>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Mão de Obra</label>
                                <input type="number" id="editMaoObra" step="0.01" value="${os.valorMaoObra || 0}" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Desconto</label>
                                <input type="number" id="editDesconto" step="0.01" value="${os.desconto || 0}" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Valor Final</label>
                                <input type="number" id="editValorFinal" step="0.01" value="${os.valorFinal || 0}" class="w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-100" readonly>
                            </div>
                        </div>
                        <button onclick="calcularValorFinal()" class="mt-4 bg-purple-500 text-white px-4 py-2 rounded-lg hover:bg-purple-600">
                            <i class="fas fa-calculator mr-2"></i>Calcular Total
                        </button>
                    </div>

                    <!-- Observações -->
                    <div class="bg-gray-50 p-4 rounded-xl">
                        <h4 class="text-lg font-semibold mb-4">Observações</h4>
                        <textarea id="editObservacoes" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-lg">${os.observacoes || ''}</textarea>
                    </div>

                    <!-- Botões -->
                    <div class="flex justify-end space-x-4 pt-6 border-t">
                        <button onclick="fecharModalEditarOS()" class="px-6 py-3 bg-gray-500 text-white rounded-xl hover:bg-gray-600 transition-all">
                            <i class="fas fa-times mr-2"></i>Cancelar
                        </button>
                        <button onclick="salvarEdicaoOS()" class="px-6 py-3 btn-primary text-white rounded-xl">
                            <i class="fas fa-save mr-2"></i>Salvar Alterações
                        </button>
                    </div>
                </div>
            `;
            
            document.getElementById('conteudoEditarOS').innerHTML = conteudo;
            document.getElementById('modalEditarOS').classList.add('active');
        }

        function fecharModalEditarOS() {
            document.getElementById('modalEditarOS').classList.remove('active');
            osEditandoId = null;
        }

        function adicionarPecaUtilizada() {
            const container = document.getElementById('listaPecasUtilizadas');
            const index = container.children.length;
            
            const novaPeca = document.createElement('div');
            novaPeca.className = 'flex items-center space-x-2 bg-white p-2 rounded';
            novaPeca.innerHTML = `
                <input type="text" placeholder="Nome da peça" class="flex-1 px-2 py-1 border rounded">
                <input type="number" placeholder="Qtd" class="w-20 px-2 py-1 border rounded">
                <input type="number" step="0.01" placeholder="Valor" class="w-24 px-2 py-1 border rounded">
                <button onclick="this.parentElement.remove()" class="text-red-500 hover:text-red-700">
                    <i class="fas fa-trash"></i>
                </button>
            `;
            
            container.appendChild(novaPeca);
        }

        function calcularValorFinal() {
            const maoObra = parseFloat(document.getElementById('editMaoObra').value) || 0;
            const desconto = parseFloat(document.getElementById('editDesconto').value) || 0;
            
            let totalPecas = 0;
            const pecas = document.querySelectorAll('#listaPecasUtilizadas > div');
            
            pecas.forEach(peca => {
                const quantidade = parseFloat(peca.children[1].value) || 0;
                const valor = parseFloat(peca.children[2].value) || 0;
                totalPecas += quantidade * valor;
            });
            
            const valorFinal = (maoObra + totalPecas) - desconto;
            document.getElementById('editValorFinal').value = valorFinal.toFixed(2);
        }

        function salvarEdicaoOS() {
            if (!osEditandoId) return;
            
            const os = ordensServico.find(o => o.id === osEditandoId);
            if (!os) return;
            
            const statusAnterior = os.status;
            
            // Atualizar dados
            os.status = document.getElementById('editStatus').value;
            os.tecnicoResponsavel = document.getElementById('editTecnico').value;
            os.prioridade = document.getElementById('editPrioridade').value;
            os.diagnosticoInicial = document.getElementById('editDiagnostico').value;
            os.valorMaoObra = parseFloat(document.getElementById('editMaoObra').value) || 0;
            os.desconto = parseFloat(document.getElementById('editDesconto').value) || 0;
            os.valorFinal = parseFloat(document.getElementById('editValorFinal').value) || 0;
            os.observacoes = document.getElementById('editObservacoes').value;
            os.dataAtualizacao = new Date().toISOString();
            
            // Atualizar serviços realizados
            const servicosTexto = document.getElementById('editServicos').value;
            os.servicosRealizados = servicosTexto ? servicosTexto.split(',').map(s => s.trim()) : [];
            
            // Atualizar peças utilizadas
            const pecas = [];
            const pecasElements = document.querySelectorAll('#listaPecasUtilizadas > div');
            
            pecasElements.forEach(peca => {
                const nome = peca.children[0].value.trim();
                const quantidade = parseFloat(peca.children[1].value) || 0;
                const valor = parseFloat(peca.children[2].value) || 0;
                
                if (nome && quantidade > 0) {
                    pecas.push({ nome, quantidade, valor });
                }
            });
            
            os.pecasUtilizadas = pecas;
            
            // Adicionar ao histórico
            os.historico.push({
                data: new Date().toISOString(),
                acao: 'OS Atualizada',
                usuario: os.tecnicoResponsavel || 'Sistema',
                observacao: `Status alterado de "${statusAnterior}" para "${os.status}"`
            });
            
            // Definir data de conclusão se necessário
            if (os.status === 'Concluída' || os.status === 'Entregue') {
                if (!os.dataConclusao) {
                    os.dataConclusao = new Date().toISOString().split('T')[0];
                }
            }
            
            salvarDados();
            atualizarListaOS();
            atualizarDashboard();
            fecharModalEditarOS();
            
            // Simular envio de WhatsApp se status mudou
            if (statusAnterior !== os.status) {
                simularEnvioWhatsApp(os, 'STATUS_ALTERADO');
            }
            
            alert('Ordem de serviço atualizada com sucesso!');
        }

        function atualizarStatusOS(id) {
            const os = ordensServico.find(o => o.id === id);
            if (!os) return;
            
            const novoStatus = prompt(`Status atual: ${os.status}\n\nNovo status:`, os.status);
            if (novoStatus && novoStatus !== os.status) {
                const statusAnterior = os.status;
                os.status = novoStatus;
                os.dataAtualizacao = new Date().toISOString();
                
                if (novoStatus === 'Concluída' || novoStatus === 'Entregue') {
                    if (!os.dataConclusao) {
                        os.dataConclusao = new Date().toISOString().split('T')[0];
                    }
                }
                
                os.historico.push({
                    data: new Date().toISOString(),
                    acao: 'Status Alterado',
                    usuario: 'Sistema',
                    observacao: `Status alterado de "${statusAnterior}" para "${novoStatus}"`
                });
                
                salvarDados();
                atualizarListaOS();
                atualizarDashboard();
                
                simularEnvioWhatsApp(os, 'STATUS_ALTERADO');
            }
        }

        function simularEnvioWhatsApp(os, tipo) {
            let mensagem = '';
            
            switch(tipo) {
                case 'OS_CRIADA':
                    mensagem = `Olá ${os.cliente.nome}! Sua OS ${os.numero} foi criada. Aparelho: ${os.aparelho.marca} ${os.aparelho.modelo}. Acompanhe o status pelo nosso sistema.`;
                    break;
                case 'STATUS_ALTERADO':
                    mensagem = `${os.cliente.nome}, sua OS ${os.numero} teve o status alterado para: ${os.status}. Entre em contato para mais informações.`;
                    break;
            }
            
            console.log(`WhatsApp para ${os.cliente.telefone}: ${mensagem}`);
            
            // Aqui você integraria com uma API real de WhatsApp
            // Por exemplo: WhatsApp Business API, Twilio, etc.
        }

        // Funções de Clientes
        function abrirModalNovoCliente() {
            document.getElementById('modalNovoCliente').classList.add('active');
        }

        function fecharModalNovoCliente() {
            document.getElementById('modalNovoCliente').classList.remove('active');
            document.getElementById('formNovoCliente').reset();
        }

        function salvarCliente() {
            const cliente = {
                id: Date.now(),
                nome: document.getElementById('clienteNome').value,
                telefone: document.getElementById('clienteTelefone').value,
                documento: document.getElementById('clienteDocumento').value,
                email: document.getElementById('clienteEmail').value,
                endereco: document.getElementById('clienteEndereco').value,
                observacoes: document.getElementById('clienteObservacoes').value,
                dataCadastro: new Date().toISOString()
            };
            
            if (!cliente.nome || !cliente.telefone) {
                alert('Por favor, preencha pelo menos o nome e telefone!');
                return;
            }
            
            clientes.push(cliente);
            salvarDados();
            atualizarListaClientes();
            fecharModalNovoCliente();
            
            alert('Cliente cadastrado com sucesso!');
        }

        function atualizarListaClientes() {
            const lista = document.getElementById('listaClientes');
            let clientesFiltrados = [...clientes];
            
            const busca = document.getElementById('buscaCliente').value.toLowerCase();
            if (busca) {
                clientesFiltrados = clientesFiltrados.filter(cliente =>
                    cliente.nome.toLowerCase().includes(busca) ||
                    cliente.telefone.includes(busca) ||
                    (cliente.documento && cliente.documento.includes(busca))
                );
            }
            
            lista.innerHTML = clientesFiltrados.map(cliente => {
                const osCliente = ordensServico.filter(os => os.cliente.telefone === cliente.telefone);
                
                return `
                    <div class="glass-effect p-4 rounded-xl card-hover">
                        <div class="flex justify-between items-start">
                            <div class="flex-1">
                                <h4 class="text-lg font-semibold text-gray-800">${cliente.nome}</h4>
                                <p class="text-sm text-gray-600">${cliente.telefone}</p>
                                ${cliente.email ? `<p class="text-sm text-gray-600">${cliente.email}</p>` : ''}
                                ${cliente.documento ? `<p class="text-sm text-gray-600">Doc: ${cliente.documento}</p>` : ''}
                                <p class="text-xs text-gray-500">Cadastrado em: ${new Date(cliente.dataCadastro).toLocaleDateString('pt-BR')}</p>
                            </div>
                            <div class="text-right">
                                <p class="text-sm font-medium text-blue-600">${osCliente.length} OS</p>
                                <button onclick="verHistoricoCliente('${cliente.telefone}')" class="mt-2 text-xs bg-blue-500 text-white px-3 py-1 rounded-full hover:bg-blue-600 transition-all">
                                    <i class="fas fa-history mr-1"></i> Histórico
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            }).join('') || '<p class="text-gray-500 text-center">Nenhum cliente encontrado</p>';
        }

        function buscarClientes() {
            atualizarListaClientes();
        }

        function verHistoricoCliente(telefone) {
            const osCliente = ordensServico.filter(os => os.cliente.telefone === telefone);
            
            if (osCliente.length === 0) {
                alert('Este cliente não possui histórico de ordens de serviço.');
                return;
            }
            
            let historico = `HISTÓRICO DO CLIENTE\n\n`;
            osCliente.forEach(os => {
                historico += `OS: ${os.numero}\n`;
                historico += `Aparelho: ${os.aparelho.marca} ${os.aparelho.modelo}\n`;
                historico += `Status: ${os.status}\n`;
                historico += `Data: ${new Date(os.dataAbertura).toLocaleDateString('pt-BR')}\n`;
                historico += `Valor: R$ ${(os.valorFinal || os.valorEstimado).toFixed(2)}\n\n`;
            });
            
            alert(historico);
        }

        // Funções Financeiras
        function adicionarTransacao() {
            const tipo = document.getElementById('tipoTransacao').value;
            const descricao = document.getElementById('descricaoTransacao').value;
            const valor = parseFloat(document.getElementById('valorTransacao').value);
            const data = document.getElementById('dataTransacao').value;
            
            if (!descricao || !valor || !data) {
                alert('Por favor, preencha todos os campos!');
                return;
            }
            
            const transacao = {
                id: Date.now(),
                tipo,
                descricao,
                valor,
                data
            };
            
            transacoes.push(transacao);
            salvarDados();
            atualizarListaTransacoes();
            atualizarResumoFinanceiro();
            limparFormularioTransacao();
            
            alert('Transação adicionada com sucesso!');
        }

        function atualizarListaTransacoes() {
            const lista = document.getElementById('listaTransacoes');
            const transacoesRecentes = transacoes.slice(-10).reverse();
            
            lista.innerHTML = transacoesRecentes.map(transacao => `
                <div class="glass-effect p-4 rounded-xl card-hover">
                    <div class="flex justify-between items-start">
                        <div>
                            <p class="font-medium text-gray-800">${transacao.descricao}</p>
                            <p class="text-xs text-gray-500">${new Date(transacao.data).toLocaleDateString('pt-BR')}</p>
                        </div>
                        <div class="text-right">
                            <p class="font-bold ${transacao.tipo === 'receita' ? 'text-green-600' : 'text-red-600'}">
                                ${transacao.tipo === 'receita' ? '+' : '-'} R$ ${transacao.valor.toFixed(2)}
                            </p>
                            <button onclick="removerTransacao(${transacao.id})" class="text-red-500 hover:text-red-700 text-xs mt-1">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                </div>
            `).join('') || '<p class="text-gray-500 text-center">Nenhuma transação registrada</p>';
        }

        function atualizarResumoFinanceiro() {
            const receitas = transacoes.filter(t => t.tipo === 'receita').reduce((sum, t) => sum + t.valor, 0);
            const despesas = transacoes.filter(t => t.tipo === 'despesa').reduce((sum, t) => sum + t.valor, 0);
            const saldo = receitas - despesas;
            
            document.getElementById('totalReceitas').textContent = `R$ ${receitas.toFixed(2)}`;
            document.getElementById('totalDespesas').textContent = `R$ ${despesas.toFixed(2)}`;
            document.getElementById('saldoTotal').textContent = `R$ ${saldo.toFixed(2)}`;
        }

        function removerTransacao(id) {
            if (confirm('Tem certeza que deseja remover esta transação?')) {
                transacoes = transacoes.filter(t => t.id !== id);
                salvarDados();
                atualizarListaTransacoes();
                atualizarResumoFinanceiro();
            }
        }

        function limparFormularioTransacao() {
            document.getElementById('descricaoTransacao').value = '';
            document.getElementById('valorTransacao').value = '';
        }

        // Funções de Relatórios
        function gerarRelatorio() {
            const tipo = document.getElementById('tipoRelatorio').value;
            const dataInicial = document.getElementById('dataInicial').value;
            const dataFinal = document.getElementById('dataFinal').value;
            const area = document.getElementById('areaRelatorio');
            
            if (!dataInicial || !dataFinal) {
                alert('Por favor, selecione as datas!');
                return;
            }
            
            let conteudo = '';
            
            switch(tipo) {
                case 'vendas':
                    conteudo = gerarRelatorioVendas(dataInicial, dataFinal);
                    break;
                case 'servicos':
                    conteudo = gerarRelatorioServicos(dataInicial, dataFinal);
                    break;
                case 'financeiro':
                    conteudo = gerarRelatorioFinanceiro(dataInicial, dataFinal);
                    break;
                case 'estoque':
                    conteudo = gerarRelatorioEstoque();
                    break;
                case 'clientes':
                    conteudo = gerarRelatorioClientes();
                    break;
            }
            
            area.innerHTML = conteudo;
        }

        function gerarRelatorioVendas(dataInicial, dataFinal) {
            const vendasPeriodo = vendas.filter(v => {
                const dataVenda = new Date(v.data.split(' ')[0].split('/').reverse().join('-'));
                return dataVenda >= new Date(dataInicial) && dataVenda <= new Date(dataFinal);
            });
            
            const total = vendasPeriodo.reduce((sum, v) => sum + v.valor, 0);
            
            return `
                <div class="space-y-4">
                    <h4 class="font-bold text-xl text-gray-800">Relatório de Vendas</h4>
                    <div class="grid grid-cols-3 gap-4 mb-6">
                        <div class="bg-blue-50 p-4 rounded-lg text-center">
                            <p class="text-sm text-gray-600">Período</p>
                            <p class="font-bold">${new Date(dataInicial).toLocaleDateString('pt-BR')} a ${new Date(dataFinal).toLocaleDateString('pt-BR')}</p>
                        </div>
                        <div class="bg-green-50 p-4 rounded-lg text-center">
                            <p class="text-sm text-gray-600">Total de Vendas</p>
                            <p class="font-bold text-green-600">${vendasPeriodo.length}</p>
                        </div>
                        <div class="bg-purple-50 p-4 rounded-lg text-center">
                            <p class="text-sm text-gray-600">Valor Total</p>
                            <p class="font-bold text-purple-600">R$ ${total.toFixed(2)}</p>
                        </div>
                    </div>
                    <div class="space-y-3">
                        ${vendasPeriodo.map(v => `
                            <div class="bg-white p-4 rounded-lg border">
                                <div class="flex justify-between items-center">
                                    <div>
                                        <p class="font-medium">${v.cliente}</p>
                                        <p class="text-sm text-gray-600">${v.produto} (${v.quantidade}x)</p>
                                        <p class="text-xs text-gray-500">${v.data} - ${v.pagamento}</p>
                                    </div>
                                    <p class="font-bold text-green-600">R$ ${v.valor.toFixed(2)}</p>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        function gerarRelatorioServicos(dataInicial, dataFinal) {
            const servicosPeriodo = ordensServico.filter(os => {
                const dataOS = new Date(os.dataAbertura);
                return dataOS >= new Date(dataInicial) && dataOS <= new Date(dataFinal);
            });
            
            const total = servicosPeriodo.reduce((sum, os) => sum + (os.valorFinal || os.valorEstimado), 0);
            const concluidas = servicosPeriodo.filter(os => os.status === 'Entregue').length;
            
            return `
                <div class="space-y-4">
                    <h4 class="font-bold text-xl text-gray-800">Relatório de Serviços</h4>
                    <div class="grid grid-cols-4 gap-4 mb-6">
                        <div class="bg-blue-50 p-4 rounded-lg text-center">
                            <p class="text-sm text-gray-600">Total de OS</p>
                            <p class="font-bold text-blue-600">${servicosPeriodo.length}</p>
                        </div>
                        <div class="bg-green-50 p-4 rounded-lg text-center">
                            <p class="text-sm text-gray-600">Concluídas</p>
                            <p class="font-bold text-green-600">${concluidas}</p>
                        </div>
                        <div class="bg-yellow-50 p-4 rounded-lg text-center">
                            <p class="text-sm text-gray-600">Em Andamento</p>
                            <p class="font-bold text-yellow-600">${servicosPeriodo.length - concluidas}</p>
                        </div>
                        <div class="bg-purple-50 p-4 rounded-lg text-center">
                            <p class="text-sm text-gray-600">Valor Total</p>
                            <p class="font-bold text-purple-600">R$ ${total.toFixed(2)}</p>
                        </div>
                    </div>
                    <div class="space-y-3">
                        ${servicosPeriodo.map(os => `
                            <div class="bg-white p-4 rounded-lg border">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <p class="font-medium">${os.numero} - ${os.cliente.nome}</p>
                                        <p class="text-sm text-gray-600">${os.aparelho.marca} ${os.aparelho.modelo}</p>
                                        <p class="text-xs text-gray-500">${os.defeitoRelatado}</p>
                                        <p class="text-xs text-gray-500">Abertura: ${new Date(os.dataAbertura).toLocaleDateString('pt-BR')}</p>
                                    </div>
                                    <div class="text-right">
                                        <span class="status-badge ${getStatusClass(os.status)}">${os.status}</span>
                                        <p class="font-bold text-green-600 mt-2">R$ ${(os.valorFinal || os.valorEstimado).toFixed(2)}</p>
                                    </div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        function gerarRelatorioFinanceiro(dataInicial, dataFinal) {
            const transacoesPeriodo = transacoes.filter(t => {
                return t.data >= dataInicial && t.data <= dataFinal;
            });
            
            const receitas = transacoesPeriodo.filter(t => t.tipo === 'receita').reduce((sum, t) => sum + t.valor, 0);
            const despesas = transacoesPeriodo.filter(t => t.tipo === 'despesa').reduce((sum, t) => sum + t.valor, 0);
            
            return `
                <div class="space-y-4">
                    <h4 class="font-bold text-xl text-gray-800">Relatório Financeiro</h4>
                    <div class="grid grid-cols-3 gap-4 mb-6">
                        <div class="bg-green-50 p-4 rounded-lg text-center">
                            <p class="text-sm text-gray-600">Receitas</p>
                            <p class="font-bold text-green-600">R$ ${receitas.toFixed(2)}</p>
                        </div>
                        <div class="bg-red-50 p-4 rounded-lg text-center">
                            <p class="text-sm text-gray-600">Despesas</p>
                            <p class="font-bold text-red-600">R$ ${despesas.toFixed(2)}</p>
                        </div>
                        <div class="bg-blue-50 p-4 rounded-lg text-center">
                            <p class="text-sm text-gray-600">Saldo</p>
                            <p class="font-bold text-blue-600">R$ ${(receitas - despesas).toFixed(2)}</p>
                        </div>
                    </div>
                    <div class="space-y-3">
                        ${transacoesPeriodo.map(t => `
                            <div class="bg-white p-4 rounded-lg border">
                                <div class="flex justify-between items-center">
                                    <div>
                                        <p class="font-medium">${t.descricao}</p>
                                        <p class="text-xs text-gray-500">${new Date(t.data).toLocaleDateString('pt-BR')}</p>
                                    </div>
                                    <p class="font-bold ${t.tipo === 'receita' ? 'text-green-600' : 'text-red-600'}">
                                        ${t.tipo === 'receita' ? '+' : '-'} R$ ${t.valor.toFixed(2)}
                                    </p>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        function gerarRelatorioEstoque() {
            const valorTotal = produtos.reduce((sum, p) => sum + (p.precoCompra * p.quantidade), 0);
            const produtosBaixoEstoque = produtos.filter(p => p.quantidade <= 5);
            
            return `
                <div class="space-y-4">
                    <h4 class="font-bold text-xl text-gray-800">Relatório de Estoque</h4>
                    <div class="grid grid-cols-3 gap-4 mb-6">
                        <div class="bg-blue-50 p-4 rounded-lg text-center">
                            <p class="text-sm text-gray-600">Total de Produtos</p>
                            <p class="font-bold text-blue-600">${produtos.length}</p>
                        </div>
                        <div class="bg-green-50 p-4 rounded-lg text-center">
                            <p class="text-sm text-gray-600">Valor Total</p>
                            <p class="font-bold text-green-600">R$ ${valorTotal.toFixed(2)}</p>
                        </div>
                        <div class="bg-red-50 p-4 rounded-lg text-center">
                            <p class="text-sm text-gray-600">Estoque Baixo</p>
                            <p class="font-bold text-red-600">${produtosBaixoEstoque.length}</p>
                        </div>
                    </div>
                    <div class="space-y-3">
                        ${produtos.map(p => `
                            <div class="bg-white p-4 rounded-lg border">
                                <div class="flex justify-between items-center">
                                    <div>
                                        <p class="font-medium">${p.nome}</p>
                                        <p class="text-sm text-gray-600">Código: ${p.codigo}</p>
                                        <p class="text-xs text-gray-500">Compra: R$ ${p.precoCompra.toFixed(2)} | Venda: R$ ${p.precoVenda.toFixed(2)}</p>
                                    </div>
                                    <div class="text-right">
                                        <p class="font-bold ${p.quantidade > 10 ? 'text-green-600' : p.quantidade > 5 ? 'text-yellow-600' : 'text-red-600'}">
                                            ${p.quantidade} unidades
                                        </p>
                                        <p class="text-xs text-gray-500">Valor: R$ ${(p.precoCompra * p.quantidade).toFixed(2)}</p>
                                    </div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        function gerarRelatorioClientes() {
            const clientesComOS = clientes.map(cliente => {
                const osCliente = ordensServico.filter(os => os.cliente.telefone === cliente.telefone);
                const valorTotal = osCliente.reduce((sum, os) => sum + (os.valorFinal || os.valorEstimado), 0);
                return { ...cliente, totalOS: osCliente.length, valorTotal };
            }).sort((a, b) => b.valorTotal - a.valorTotal);
            
            return `
                <div class="space-y-4">
                    <h4 class="font-bold text-xl text-gray-800">Relatório de Clientes</h4>
                    <div class="grid grid-cols-3 gap-4 mb-6">
                        <div class="bg-blue-50 p-4 rounded-lg text-center">
                            <p class="text-sm text-gray-600">Total de Clientes</p>
                            <p class="font-bold text-blue-600">${clientes.length}</p>
                        </div>
                        <div class="bg-green-50 p-4 rounded-lg text-center">
                            <p class="text-sm text-gray-600">Com Histórico</p>
                            <p class="font-bold text-green-600">${clientesComOS.filter(c => c.totalOS > 0).length}</p>
                        </div>
                        <div class="bg-purple-50 p-4 rounded-lg text-center">
                            <p class="text-sm text-gray-600">Valor Total Gerado</p>
                            <p class="font-bold text-purple-600">R$ ${clientesComOS.reduce((sum, c) => sum + c.valorTotal, 0).toFixed(2)}</p>
                        </div>
                    </div>
                    <div class="space-y-3">
                        ${clientesComOS.map(c => `
                            <div class="bg-white p-4 rounded-lg border">
                                <div class="flex justify-between items-center">
                                    <div>
                                        <p class="font-medium">${c.nome}</p>
                                        <p class="text-sm text-gray-600">${c.telefone}</p>
                                        <p class="text-xs text-gray-500">Cadastrado: ${new Date(c.dataCadastro).toLocaleDateString('pt-BR')}</p>
                                    </div>
                                    <div class="text-right">
                                        <p class="font-bold text-blue-600">${c.totalOS} OS</p>
                                        <p class="text-sm text-green-600">R$ ${c.valorTotal.toFixed(2)}</p>
                                    </div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        function exportarPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            const tipo = document.getElementById('tipoRelatorio').value;
            const dataInicial = document.getElementById('dataInicial').value;
            const dataFinal = document.getElementById('dataFinal').value;
            
            // Cabeçalho
            doc.setFontSize(20);
            doc.text('ASSISTÊNCIA GALEGO CELL', 20, 20);
            doc.setFontSize(12);
            doc.text('Rua Tijuana, 19 - (84) 98718-1612', 20, 30);
            
            // Título do relatório
            doc.setFontSize(16);
            let titulo = '';
            switch(tipo) {
                case 'vendas': titulo = 'Relatório de Vendas'; break;
                case 'servicos': titulo = 'Relatório de Serviços'; break;
                case 'financeiro': titulo = 'Relatório Financeiro'; break;
                case 'estoque': titulo = 'Relatório de Estoque'; break;
                case 'clientes': titulo = 'Relatório de Clientes'; break;
            }
            doc.text(titulo, 20, 50);
            
            if (dataInicial && dataFinal) {
                doc.setFontSize(10);
                doc.text(`Período: ${new Date(dataInicial).toLocaleDateString('pt-BR')} a ${new Date(dataFinal).toLocaleDateString('pt-BR')}`, 20, 60);
            }
            
            // Conteúdo específico por tipo
            let yPosition = 80;
            
            if (tipo === 'vendas') {
                const vendasPeriodo = vendas.filter(v => {
                    const dataVenda = new Date(v.data.split(' ')[0].split('/').reverse().join('-'));
                    return dataVenda >= new Date(dataInicial) && dataVenda <= new Date(dataFinal);
                });
                
                doc.setFontSize(12);
                doc.text(`Total de Vendas: ${vendasPeriodo.length}`, 20, yPosition);
                yPosition += 10;
                doc.text(`Valor Total: R$ ${vendasPeriodo.reduce((sum, v) => sum + v.valor, 0).toFixed(2)}`, 20, yPosition);
                yPosition += 20;
                
                doc.setFontSize(10);
                vendasPeriodo.forEach(venda => {
                    if (yPosition > 270) {
                        doc.addPage();
                        yPosition = 20;
                    }
                    doc.text(`${venda.cliente} - ${venda.produto} (${venda.quantidade}x) - R$ ${venda.valor.toFixed(2)}`, 20, yPosition);
                    yPosition += 8;
                });
            }
            
            if (tipo === 'servicos') {
                const servicosPeriodo = ordensServico.filter(os => {
                    const dataOS = new Date(os.dataAbertura);
                    return dataOS >= new Date(dataInicial) && dataOS <= new Date(dataFinal);
                });
                
                doc.setFontSize(12);
                doc.text(`Total de OS: ${servicosPeriodo.length}`, 20, yPosition);
                yPosition += 10;
                doc.text(`Concluídas: ${servicosPeriodo.filter(os => os.status === 'Entregue').length}`, 20, yPosition);
                yPosition += 10;
                doc.text(`Valor Total: R$ ${servicosPeriodo.reduce((sum, os) => sum + (os.valorFinal || os.valorEstimado), 0).toFixed(2)}`, 20, yPosition);
                yPosition += 20;
                
                doc.setFontSize(10);
                servicosPeriodo.forEach(os => {
                    if (yPosition > 270) {
                        doc.addPage();
                        yPosition = 20;
                    }
                    doc.text(`${os.numero} - ${os.cliente.nome} - ${os.aparelho.marca} ${os.aparelho.modelo} - ${os.status}`, 20, yPosition);
                    yPosition += 8;
                });
            }
            
            if (tipo === 'estoque') {
                const valorTotal = produtos.reduce((sum, p) => sum + (p.precoCompra * p.quantidade), 0);
                
                doc.setFontSize(12);
                doc.text(`Total de Produtos: ${produtos.length}`, 20, yPosition);
                yPosition += 10;
                doc.text(`Valor Total em Estoque: R$ ${valorTotal.toFixed(2)}`, 20, yPosition);
                yPosition += 20;
                
                doc.setFontSize(10);
                produtos.forEach(produto => {
                    if (yPosition > 270) {
                        doc.addPage();
                        yPosition = 20;
                    }
                    doc.text(`${produto.nome} - ${produto.codigo} - ${produto.quantidade} unidades - R$ ${produto.precoVenda.toFixed(2)}`, 20, yPosition);
                    yPosition += 8;
                });
            }
            
            // Rodapé
            const pageCount = doc.internal.getNumberOfPages();
            for (let i = 1; i <= pageCount; i++) {
                doc.setPage(i);
                doc.setFontSize(8);
                doc.text(`Página ${i} de ${pageCount} - Gerado em ${new Date().toLocaleString('pt-BR')}`, 20, 290);
            }
            
            doc.save(`${titulo.replace(/\s+/g, '_')}_${new Date().toISOString().split('T')[0]}.pdf`);
        }

        function gerarComprovanteVendaEspecifica(vendaId) {
            const venda = vendas.find(v => v.id === vendaId);
            if (!venda) return;
            
            const { jsPDF } = window.jsPdf;
            const doc = new jsPDF();
            
            // Cabeçalho da empresa
            doc.setFontSize(18);
            doc.text('ASSISTÊNCIA GALEGO CELL', 20, 20);
            doc.setFontSize(12);
            doc.text('Rua Tijuana, 19', 20, 30);
            doc.text('Telefone: (84) 98718-1612', 20, 40);
            
            // Título
            doc.setFontSize(16);
            doc.text('COMPROVANTE DE VENDA', 20, 60);
            
            // Dados da venda
            doc.setFontSize(12);
            doc.text(`Cliente: ${venda.cliente}`, 20, 80);
            doc.text(`Produto: ${venda.produto}`, 20, 90);
            doc.text(`Quantidade: ${venda.quantidade}`, 20, 100);
            doc.text(`Valor Unitário: R$ ${(venda.valor / venda.quantidade).toFixed(2)}`, 20, 110);
            doc.text(`Valor Total: R$ ${venda.valor.toFixed(2)}`, 20, 120);
            doc.text(`Forma de Pagamento: ${venda.pagamento}`, 20, 130);
            doc.text(`Data: ${venda.data}`, 20, 140);
            
            // Rodapé
            doc.setFontSize(10);
            doc.text('Obrigado pela preferência!', 20, 180);
            doc.text('Garantia conforme Código de Defesa do Consumidor', 20, 190);
            
            doc.save(`Comprovante_Venda_${venda.id}.pdf`);
        }

        function gerarComprovanteOSEspecifica(osId) {
            const os = ordensServico.find(o => o.id === osId);
            if (!os) return;
            
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            // Cabeçalho da empresa
            doc.setFontSize(18);
            doc.text('ASSISTÊNCIA GALEGO CELL', 20, 20);
            doc.setFontSize(12);
            doc.text('Rua Tijuana, 19', 20, 30);
            doc.text('Telefone: (84) 98718-1612', 20, 40);
            
            // Título
            doc.setFontSize(16);
            doc.text(`ORDEM DE SERVIÇO - ${os.numero}`, 20, 60);
            
            // Dados do cliente
            doc.setFontSize(14);
            doc.text('DADOS DO CLIENTE:', 20, 80);
            doc.setFontSize(12);
            doc.text(`Nome: ${os.cliente.nome}`, 20, 90);
            doc.text(`Telefone: ${os.cliente.telefone}`, 20, 100);
            if (os.cliente.documento) doc.text(`CPF/CNPJ: ${os.cliente.documento}`, 20, 110);
            if (os.cliente.endereco) doc.text(`Endereço: ${os.cliente.endereco}`, 20, 120);
            
            // Dados do aparelho
            let yPos = os.cliente.endereco ? 140 : 130;
            doc.setFontSize(14);
            doc.text('DADOS DO APARELHO:', 20, yPos);
            doc.setFontSize(12);
            yPos += 10;
            doc.text(`Marca/Modelo: ${os.aparelho.marca} ${os.aparelho.modelo}`, 20, yPos);
            yPos += 10;
            if (os.aparelho.imei) {
                doc.text(`IMEI: ${os.aparelho.imei}`, 20, yPos);
                yPos += 10;
            }
            if (os.aparelho.acessorios) {
                doc.text(`Acessórios: ${os.aparelho.acessorios}`, 20, yPos);
                yPos += 10;
            }
            
            // Problema e diagnóstico
            yPos += 10;
            doc.setFontSize(14);
            doc.text('PROBLEMA RELATADO:', 20, yPos);
            doc.setFontSize(12);
            yPos += 10;
            const linhasProblema = doc.splitTextToSize(os.defeitoRelatado, 170);
            doc.text(linhasProblema, 20, yPos);
            yPos += linhasProblema.length * 7;
            
            if (os.diagnosticoInicial) {
                yPos += 10;
                doc.setFontSize(14);
                doc.text('DIAGNÓSTICO TÉCNICO:', 20, yPos);
                doc.setFontSize(12);
                yPos += 10;
                const linhasDiagnostico = doc.splitTextToSize(os.diagnosticoInicial, 170);
                doc.text(linhasDiagnostico, 20, yPos);
                yPos += linhasDiagnostico.length * 7;
            }
            
            // Serviços realizados
            if (os.servicosRealizados && os.servicosRealizados.length > 0) {
                yPos += 10;
                doc.setFontSize(14);
                doc.text('SERVIÇOS REALIZADOS:', 20, yPos);
                doc.setFontSize(12);
                yPos += 10;
                os.servicosRealizados.forEach(servico => {
                    doc.text(`• ${servico}`, 25, yPos);
                    yPos += 7;
                });
            }
            
            // Peças utilizadas
            if (os.pecasUtilizadas && os.pecasUtilizadas.length > 0) {
                yPos += 10;
                doc.setFontSize(14);
                doc.text('PEÇAS UTILIZADAS:', 20, yPos);
                doc.setFontSize(12);
                yPos += 10;
                os.pecasUtilizadas.forEach(peca => {
                    doc.text(`• ${peca.nome} - Qtd: ${peca.quantidade} - Valor: R$ ${peca.valor.toFixed(2)}`, 25, yPos);
                    yPos += 7;
                });
            }
            
            // Valores
            yPos += 15;
            doc.setFontSize(14);
            doc.text('VALORES:', 20, yPos);
            doc.setFontSize(12);
            yPos += 10;
            
            const valorPecas = (os.pecasUtilizadas || []).reduce((sum, p) => sum + (p.quantidade * p.valor), 0);
            const valorMaoObra = os.valorMaoObra || 0;
            const desconto = os.desconto || 0;
            const valorFinal = os.valorFinal || os.valorEstimado || 0;
            
            doc.text(`Peças: R$ ${valorPecas.toFixed(2)}`, 25, yPos);
            yPos += 7;
            doc.text(`Mão de Obra: R$ ${valorMaoObra.toFixed(2)}`, 25, yPos);
            yPos += 7;
            if (desconto > 0) {
                doc.text(`Desconto: R$ ${desconto.toFixed(2)}`, 25, yPos);
                yPos += 7;
            }
            doc.setFontSize(14);
            doc.text(`TOTAL: R$ ${valorFinal.toFixed(2)}`, 25, yPos);
            
            // Informações adicionais
            yPos += 20;
            doc.setFontSize(12);
            doc.text(`Status: ${os.status}`, 20, yPos);
            yPos += 7;
            doc.text(`Data de Abertura: ${new Date(os.dataAbertura).toLocaleDateString('pt-BR')}`, 20, yPos);
            yPos += 7;
            if (os.dataConclusao) {
                doc.text(`Data de Conclusão: ${new Date(os.dataConclusao).toLocaleDateString('pt-BR')}`, 20, yPos);
                yPos += 7;
            }
            doc.text(`Garantia: ${os.garantia} dias`, 20, yPos);
            yPos += 7;
            if (os.tecnicoResponsavel) {
                doc.text(`Técnico: ${os.tecnicoResponsavel}`, 20, yPos);
            }
            
            // Rodapé
            doc.setFontSize(10);
            doc.text('Obrigado pela confiança!', 20, 280);
            doc.text(`Gerado em: ${new Date().toLocaleString('pt-BR')}`, 20, 290);
            
            doc.save(`OS_${os.numero}.pdf`);
        }

        // Funções de persistência de dados
        function salvarDados() {
            localStorage.setItem('galegoCell_vendas', JSON.stringify(vendas));
            localStorage.setItem('galegoCell_produtos', JSON.stringify(produtos));
            localStorage.setItem('galegoCell_ordensServico', JSON.stringify(ordensServico));
            localStorage.setItem('galegoCell_clientes', JSON.stringify(clientes));
            localStorage.setItem('galegoCell_transacoes', JSON.stringify(transacoes));
        }

        function carregarDados() {
            const vendasSalvas = localStorage.getItem('galegoCell_vendas');
            const produtosSalvos = localStorage.getItem('galegoCell_produtos');
            const ossSalvas = localStorage.getItem('galegoCell_ordensServico');
            const clientesSalvos = localStorage.getItem('galegoCell_clientes');
            const transacoesSalvas = localStorage.getItem('galegoCell_transacoes');
            
            if (vendasSalvas) vendas = JSON.parse(vendasSalvas);
            if (produtosSalvos) produtos = JSON.parse(produtosSalvos);
            if (ossSalvas) ordensServico = JSON.parse(ossSalvas);
            if (clientesSalvos) clientes = JSON.parse(clientesSalvos);
            if (transacoesSalvas) transacoes = JSON.parse(transacoesSalvas);
            
            // Atualizar todas as listas
            atualizarListaVendas();
            atualizarListaProdutos();
            atualizarListaOS();
            atualizarListaClientes();
            atualizarListaTransacoes();
            atualizarResumoFinanceiro();
        }

        // Função para limpar todos os dados (para testes)
        function limparTodosDados() {
            if (confirm('ATENÇÃO: Isso irá apagar TODOS os dados do sistema. Tem certeza?')) {
                localStorage.clear();
                vendas = [];
                produtos = [];
                ordensServico = [];
                clientes = [];
                transacoes = [];
                
                atualizarListaVendas();
                atualizarListaProdutos();
                atualizarListaOS();
                atualizarListaClientes();
                atualizarListaTransacoes();
                atualizarResumoFinanceiro();
                atualizarDashboard();
                
                alert('Todos os dados foram removidos!');
            }
        }

        // Adicionar alguns dados de exemplo na primeira execução
        function adicionarDadosExemplo() {
            if (produtos.length === 0) {
                // Produtos de exemplo
                produtos.push(
                    { id: 1, nome: 'Película de Vidro iPhone 12', codigo: 'PEL001', precoCompra: 8.00, precoVenda: 15.00, quantidade: 25, data: new Date().toLocaleString('pt-BR') },
                    { id: 2, nome: 'Capinha Transparente Samsung A54', codigo: 'CAP001', precoCompra: 12.00, precoVenda: 25.00, quantidade: 15, data: new Date().toLocaleString('pt-BR') },
                    { id: 3, nome: 'Carregador Tipo-C 20W', codigo: 'CAR001', precoCompra: 18.00, precoVenda: 35.00, quantidade: 8, data: new Date().toLocaleString('pt-BR') },
                    { id: 4, nome: 'Fone Bluetooth TWS', codigo: 'FON001', precoCompra: 25.00, precoVenda: 45.00, quantidade: 3, data: new Date().toLocaleString('pt-BR') }
                );
                
                // Atualizar select de produtos nas vendas
                const selectProduto = document.getElementById('produtoVenda');
                selectProduto.innerHTML = '<option value="">Selecione um produto</option>';
                produtos.forEach(produto => {
                    selectProduto.innerHTML += `<option value="${produto.nome}">${produto.nome} - R$ ${produto.precoVenda.toFixed(2)}</option>`;
                });
                
                salvarDados();
                atualizarListaProdutos();
            }
        }

        // Chamar função de dados de exemplo
        setTimeout(adicionarDadosExemplo, 1000);
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9719778f227dcb3c',t:'MTc1NTYwNDU3OS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script>
